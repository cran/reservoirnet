<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Classification with Reservoir Computing</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Classification with Reservoir
Computing</h1>



<p>Reservoir Computing (RC) is well suited to both regression and
classification tasks. In the following notebook, you will experiment
with a simple example of classification task.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reservoirnet)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="classification---the-japanese-vowel-dataset" class="section level1">
<h1>Classification - The Japanese vowel dataset</h1>
<p>The Japanese vowel dataset is composed of 640 utterances of the
Japanese vowel , from 9 different male speakers. The goal of this task
is to assign to each utterance the label of its speaker. Dataset is
split between a 270 utterances training set and a 340 utterances testing
set.</p>
<p>Each spoken utterance is a timeseries of 7~29 timesteps. Each
timestep of signal is a 12 dimensional vector representing Linear
Prediction Coefficient (LPC), which encode the audio signal into the
cepstral domain (a variant of the frequency domain).</p>
<p>References M. Kudo, J. Toyama and M. Shimbo. (1999).
“Multidimensional Curve Classification Using Passing-Through Regions”.
Pattern Recognition Letters, Vol. 20, No. 11–13, pages 1103–1111.</p>
<p><a href="https://archive.ics.uci.edu/ml/machine-learning-databases/JapaneseVowels-mld/" class="uri">https://archive.ics.uci.edu/ml/machine-learning-databases/JapaneseVowels-mld/</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>japanese_vowels <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">generate_data</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="st">&quot;japanese_vowels&quot;</span>)<span class="sc">$</span>japanese_vowels</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>X_train</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Y_train <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>Y_train</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>X_test</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Y_test <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>Y_test</span></code></pre></div>
</div>
<div id="echo-state-network-setup" class="section level1">
<h1>Echo state network setup</h1>
<p>First we will define a reservoir network :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sample_per_speaker <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n_speaker <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>X_train_per_speaker <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a> X_speaker <span class="ot">&lt;-</span> X_train[((i<span class="sc">*</span>sample_per_speaker)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>((i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>sample_per_speaker)]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a> X_train_per_speaker[[i<span class="sc">+</span><span class="dv">1</span>]]<span class="ot">&lt;-</span>(<span class="fu">as.numeric</span>(<span class="fu">unlist</span>(<span class="fu">sapply</span>(X_speaker, t))))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">LPC =</span> <span class="fu">unlist</span>(X_train_per_speaker), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">Speaker =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">times =</span> <span class="fu">sapply</span>(X_train_per_speaker,length))))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d,<span class="fu">aes</span>(<span class="at">x =</span> Speaker, <span class="at">y =</span> LPC)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">plot of chunk boxplotvowel</p>
</div>
<p>##Transduction (sequence-to-sequence model)</p>
<p>As ReservoirPy Nodes are built to work on sequences, the simplest
setup to solve this task is sequence-to-sequence encoding, also called
transduction. A model is trained on encoding each vector of input
sequence into a new vector in the output space. Thus, a sequence of
audio yields a sequence of label, one label per timestep.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>japanese_vowels <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">generate_data</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="st">&quot;japanese_vowels&quot;</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">repeat_targets=</span><span class="cn">TRUE</span>)<span class="sc">$</span>japanese_vowels</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>X_train</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Y_train <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>Y_train</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>X_test</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>Y_test <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>Y_test</span></code></pre></div>
<div id="train-a-simple-echo-state-network-to-solve-this-task" class="section level2">
<h2>Train a simple Echo State Network to solve this task:</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>source <span class="ot">&lt;-</span> <span class="fu">createNode</span>(<span class="st">&quot;Input&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>readout <span class="ot">&lt;-</span> <span class="fu">createNode</span>(<span class="st">&quot;Ridge&quot;</span>,<span class="at">ridge=</span><span class="fl">1e-6</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>reservoir <span class="ot">&lt;-</span> <span class="fu">createNode</span>(<span class="st">&quot;Reservoir&quot;</span>,<span class="at">units =</span> <span class="dv">500</span>,<span class="at">lr=</span><span class="fl">0.1</span>, <span class="at">sr=</span><span class="fl">0.9</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#[source &gt;&gt; reservoir, source] &gt;&gt; readout</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">list</span>(source <span class="sc">%&gt;&gt;%</span> reservoir, source) <span class="sc">%&gt;&gt;%</span> readout</span></code></pre></div>
</div>
<div id="fit-the-model" class="section level2">
<h2>Fit the model</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_fit <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">reservoirR_fit</span>(<span class="at">node =</span> model,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">X =</span> X_train,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">Y =</span> Y_train,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">stateful =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">warmup =</span> <span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">predict_seq</span>(<span class="at">node =</span> model_fit<span class="sc">$</span>fit,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">X =</span> X_test,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">stateful =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Get the scores:</p>
<p>There are 9 speakers, hence the output space is 9-dimensional. The
speaker label is the index of the output neuron with maximum
activation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="cf">function</span>(pred, truth){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(pred <span class="sc">==</span> truth)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Y_pred_class <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Y_pred, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">apply</span>(<span class="fu">as.matrix</span>(x),<span class="dv">1</span>,which.max))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Y_test_class <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Y_test, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">apply</span>(<span class="fu">as.matrix</span>(x),<span class="dv">1</span>,which.max))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="fu">array</span>(<span class="fu">unlist</span>(Y_pred_class)), <span class="fu">array</span>(<span class="fu">unlist</span>(Y_test_class)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Accuracy: &quot;</span>, <span class="fu">round</span>(score <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">3</span>) ,<span class="st">&quot;%&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Accuracy: 91.296%&quot;</code></pre>
</div>
</div>
<div id="classification-sequence-to-vector-model" class="section level1">
<h1>Classification (sequence-to-vector model)</h1>
<p>We can create a more elaborated model where inference is performed
only once on the whole input sequence. Indeed, we only need to assign
one label to each input sequence. This new setup is known as a
sequence-to-vector model, and this is usually the type of model we refer
to when talking about classification of sequencial patterns.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>japanese_vowels <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">generate_data</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset =</span> <span class="st">&quot;japanese_vowels&quot;</span>)<span class="sc">$</span>japanese_vowels</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>X_train</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>Y_train <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>Y_train</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>X_test</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>Y_test <span class="ot">&lt;-</span> japanese_vowels<span class="sc">$</span>Y_test</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>source <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">createNode</span>(<span class="st">&quot;Input&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>readout <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">createNode</span>(<span class="st">&quot;Ridge&quot;</span>,<span class="at">ridge=</span><span class="fl">1e-6</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>reservoir <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">createNode</span>(<span class="st">&quot;Reservoir&quot;</span>, <span class="at">units =</span> <span class="dv">500</span>, <span class="at">lr=</span><span class="fl">0.1</span>, <span class="at">sr=</span><span class="fl">0.9</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#source &gt;&gt; reservoir &gt;&gt; readout</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> source <span class="sc">%&gt;&gt;%</span> reservoir <span class="sc">%&gt;&gt;%</span> readout</span></code></pre></div>
<p>We need to modify the training loop by hand a bit to perform this
task:</p>
<p>first, we compute all reservoir states over the input sequence using
the reservoir.run method. then, we gather in a list only the last vector
of the states sequence.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>states_train <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> X_train) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  states <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">predict_seq</span>(<span class="at">node =</span> reservoir, <span class="at">X =</span> x, <span class="at">reset=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  states_train[[k]] <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(states[<span class="fu">nrow</span>(states),]))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now train the readout only on the last state vectors. Here,
Y_train is an array storing a single label for each utterance.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">reservoirR_fit</span>(readout,<span class="at">X =</span> states_train, <span class="at">Y =</span> Y_train)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span></code></pre></div>
<pre><code>## Parametrs using to fit:
##  warmup: 0 ; stateful: FALSE ; reset: FALSE 
## results of fitting:
## &#39;Ridge-5&#39;: Ridge(ridge=1e-06, input_bias=True, in=500, out=9)</code></pre>
<p>We also modify the inference code using the same method as above:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> X_test) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  states <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">predict_seq</span>(<span class="at">node =</span> reservoir, <span class="at">X =</span> x, <span class="at">reset=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> reservoirnet<span class="sc">::</span><span class="fu">predict_seq</span>(<span class="at">node =</span> readout, <span class="at">X =</span> <span class="fu">as.array</span>(states[<span class="fu">nrow</span>(states),]))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  Y_pred[[k]] <span class="ot">&lt;-</span> y</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Y_pred_class <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Y_pred, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">apply</span>(<span class="fu">as.matrix</span>(x),<span class="dv">1</span>,which.max))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Y_test_class <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Y_test, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">apply</span>(<span class="fu">as.matrix</span>(x),<span class="dv">1</span>,which.max))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">accuracy</span>(<span class="at">pred =</span> Y_test_class,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">truth =</span> Y_pred_class)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Accuracy: &quot;</span>, <span class="fu">round</span>(score <span class="sc">*</span> <span class="dv">100</span>,<span class="dv">3</span>) ,<span class="st">&quot;%&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Accuracy: 88.108%&quot;</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
